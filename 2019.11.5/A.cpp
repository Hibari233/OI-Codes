#include<cstdio>
#include<cstring>
using namespace std;const long long MAXN=1005000;long long T,n,h,r,cnt1,cnt2,l,s[MAXN],pos_x[MAXN],pos_y[MAXN],pos_z[MAXN],ground_z[MAXN],top_z[MAXN];long long dist_pow(long long x1,long long y1,long long z1,long long x2,long long y2,long long z2){return 1ll*(x1-x2)*(x1-x2)+1ll*(y1-y2)*(y1-y2)+1ll*(z1-z2)*(z1-z2);}void init(int n){for(int i=1;i<=n;i++)s[i]=i;cnt1=0;cnt2=0;}long long find(int p){return s[p]=p==s[p]?p:find(s[p]);}void uni(int p,int q){s[find(p)]=find(q);}int main(){scanf("%lld",&T);for(int p=1;p<=T;p++){memset(ground_z,0,sizeof(ground_z));memset(top_z,0,sizeof(top_z));scanf("%lld%lld%lld",&n,&h,&r);init(n);for(int i=1;i<=n;i++){scanf("%lld%lld%lld",&pos_x[i],&pos_y[i],&pos_z[i]);if(pos_z[i]>=h-r) top_z[++cnt1]=i;if(pos_z[i]<=r) ground_z[++cnt2]=i;}for(int i=1;i<=n;i++){for(int j=1;j<=n;j++){l=dist_pow(pos_x[i],pos_y[i],pos_z[i],pos_x[j],pos_y[j],pos_z[j]);if(l<=(2*r)*(2*r)) uni(i,j);}}bool mark=false;for(int i=1;ground_z[i]!=0;i++){if(mark==true) continue;for(int j=1;top_z[j]!=0;j++){if(ground_z[i]==top_z[j]){printf("Yes\n");mark=true;}if(find(ground_z[i])==find(top_z[j])){if(mark==false){printf("Yes\n");mark=true;}}}}if(mark==false) printf("No\n");}return 0;}